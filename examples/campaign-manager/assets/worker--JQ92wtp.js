(function(){"use strict";var A=(t=>(t.ADD="add",t.SEARCH="searchBy",t.FILTER="filterBy",t.INIT="init",t.RESET="reset",t.PAGINATE="paginate",t.UPDATE="update",t))(A||{});const S={limit:parseInt("10",10),storage:[],state:[],filtersBy:{searchBy:"",dateRange:{start:"",end:""}},count:0,currentPage:1,total:0};let r=S;onmessage=function(t){var c,i,u,f,m,p;if(!t.data.type||!w(t.data.type))return;const{type:e}=t.data;if(e==="init"&&P(t.data.state)){const{state:a}=t.data;if(!P(r.storage)){const n=B(a),o=y(t.data,{storage:a,state:h(a),total:a.length,count:n});d(x(o))}return}if(e==="add"){if(!P(t.data.state))return;const{state:a}=t.data,n=[...r.storage||[],...a||[]];let o=y(t.data,{storage:n,total:n.length}),s=o.storage;if(r.filtersBy.searchBy){const{filtersBy:{searchBy:l}}=r;s=R(o.storage,l)}if((c=r.filtersBy.dateRange)!=null&&c.start&&((i=r.filtersBy.dateRange)!=null&&i.end)){const{filtersBy:{dateRange:l}}=r;s=D(s,l.start,l.end)}s=h(s),o=y(t.data,{state:s}),s=s==null?void 0:s.slice(0,r.limit),d(v(o,s));return}if(e==="searchBy"){if(((u=t.data.filtersBy)==null?void 0:u.searchBy)==r.filtersBy.searchBy)return;const{filtersBy:a}=t.data;let n=r.storage;if((f=r.filtersBy.dateRange)!=null&&f.start&&((m=r.filtersBy.dateRange)!=null&&m.end)){const{filtersBy:{dateRange:l}}=r;n=D(n,l.start,l.end)}a!=null&&a.searchBy&&(n=R(n,(a==null?void 0:a.searchBy)||""));const o=n==null?void 0:n.slice(0,r.limit),s=y(t.data,{state:n});d(E(s,o));return}if(e==="reset"){const a=r.storage.slice(0,10),n=y(t.data,{...S,state:a,count:B(r.storage),filtersBy:{searchBy:"",dateRange:{start:"",end:""}}});d(N(n));return}if(e==="paginate"){const{nextPage:a}=t.data,n=((a||1)-1)*r.limit,o=Math.min(n+r.limit,r.state.length),s=r.state.slice(n,o);d(I({state:s,currentPage:a||1}));return}if(e==="filterBy"){if(!((p=t.data.filtersBy)!=null&&p.dateRange))return;const{filtersBy:{dateRange:a}}=t.data;if(!(a!=null&&a.start)||!(a!=null&&a.end))return;let n=r.storage;const{start:o,end:s}=a;if(r.filtersBy.searchBy){const{filtersBy:{searchBy:L}}=r;n=R(n,L)}n=D(n,o,s),n=h(n);const l=n==null?void 0:n.slice(0,r.limit),C=y(t.data,{state:n});d(E(C,l));return}};const y=(t,e)=>(r={...r,storage:(e==null?void 0:e.storage)||r.storage||[],state:(e==null?void 0:e.state)||[],filtersBy:{...r.filtersBy,...t.filtersBy||{},...(e==null?void 0:e.filtersBy)||{}},count:(e==null?void 0:e.count)||r.count||0,total:(e==null?void 0:e.total)||r.total||0,currentPage:(e==null?void 0:e.currentPage)||1},r),x=t=>{const e=h(t.storage||[]);return{state:e==null?void 0:e.slice(0,r.limit),count:t.count,total:t.total,type:"init"}},I=t=>({state:t.state,count:B(r.state),total:r.total,type:"update",currentPage:t.currentPage,filtersBy:t.filtersBy}),v=(t,e)=>({state:e,count:B(t.state||[]),total:t.total,type:"update",currentPage:1,filtersBy:t.filtersBy}),E=(t,e)=>({state:e,count:B(t.state||[]),total:t.total,type:"update",currentPage:1,filtersBy:t.filtersBy}),N=t=>({type:"update",total:t.total,count:t.count,state:t.state,filtersBy:t.filtersBy,currentPage:1}),P=t=>Array.isArray(t)&&t.length>0,w=t=>Object.values(A).includes(t),B=t=>Math.ceil(t.length/r.limit),D=(t,e,c)=>{try{const i=g(e,"/"),u=g(c,"/");return t.filter(f=>{const m=g(f.startDate,"/"),p=g(f.endDate,"/");return m>=i&&p<=u})}catch(i){return console.error(i),[]}},R=(t,e)=>t.filter(c=>c.name.toLowerCase().trim().includes(e.toLowerCase().trim()||"")),g=(t,e="/")=>{const[c,i,u]=t.split(e).map(f=>f.padStart(2,"0"));return new Date(`${u}-${c}-${i}`)},h=t=>t.sort((e,c)=>{const i=g(e.startDate,"/"),u=g(c.startDate,"/");return i.valueOf()-u.valueOf()}),d=t=>{postMessage(t)}})();
